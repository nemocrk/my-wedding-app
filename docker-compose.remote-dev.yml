services:
  # ---------------------------------------------
  # BACKEND - Abilita Django Dev Server
  # ---------------------------------------------
  adminer:
    ports: !reset []
    networks:
      remote-dev-network: {}
  backend:
    ports: !reset []
    volumes: !reset
      - dev_static_volume:/app/staticfiles
      - dev_media_volume:/app/media
    environment:
      - DEBUG=True

  # ---------------------------------------------
  # FRONTEND USER - Abilita Vite Dev Server
  # ---------------------------------------------
  frontend-user:
    ports: !reset []
    volumes: !reset []
    build:
      target: production

  # ---------------------------------------------
  # FRONTEND ADMIN - Abilita Vite Dev Server
  # ---------------------------------------------
  frontend-admin:
    ports: !reset []
    volumes: !reset []
    build:
      target: production
      args:
        REACT_APP_API_URL: ${REACT_APP_ADMIN_API_URL:-http://dev-wed-app-nginx-intranet/api}

  # ---------------------------------------------
  # 5. NGINX PUBLIC - Gateway Internet (solo frontend-user)
  # ---------------------------------------------
  nginx-public:
    ports: !reset []
    networks:
      remote-dev-network: {}

  # ---------------------------------------------
  # 6. NGINX INTRANET - Gateway Intranet (solo frontend-admin)
  # ---------------------------------------------
  nginx-intranet:
    ports: !reset []
    networks:
      remote-dev-network: {}

  # ---------------------------------------------
  # WHATSAPP INTEGRATION (Dev Overrides)
  # ---------------------------------------------

  # Integration Layer - Hot Reload Node.js
  whatsapp-integration:
    ports: !reset []

  # Worker Django (Esegue command custom in modalit√† dev con reload se supportato)
  backend-worker:
    ports: !reset []
    volumes: !reset
      - dev_static_volume_worker:/app/staticfiles
      - dev_media_volume_worker:/app/media
    environment:
      DEBUG: "True"

networks:
  remote-dev-network:
    external: true
